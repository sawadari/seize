# Seize Web UI

**人間とAIの1on1インタラクションを促進する、グラフィカルなWebインターフェース**

---

## 🎯 概要

Seize Web UIは、統一エージェント方程式に基づくAIエージェントとの対話を可視化するWebアプリケーションです。

### 主な機能

- **グラフィカル可視化**: 世界の状態遷移をノード・エッジで表示（React Flow）
- **1on1チャット**: 人間とAIの自然言語対話
- **リアルタイム状態表示**: エージェントの処理フェーズ、進捗、収束率を表示
- **瞬く景色**: 統一エージェント方程式の「Flickering Scenery」を体感

---

## 🚀 クイックスタート

### 前提条件

- Node.js 18以上
- npm または yarn

### インストール

```bash
cd web
npm install
```

### 開発サーバー起動

```bash
npm run dev
```

ブラウザで http://localhost:3000 を開く

### 🎬 デモを試す

開発サーバーを起動すると、**ECサイト認証機能改善プロジェクト**のデモが自動で読み込まれます。

右上の「🎬 デモ: ECサイト認証機能改善」パネルから:

1. **▶️ 再生**: 統一エージェント方程式の全プロセスを自動再生（3秒間隔）
2. **次へ ➡️ / ⬅️ 前へ**: 手動でステップを移動
3. **ステップバー**: 任意のステップに直接ジャンプ

**デモで可視化される内容**:
- Step 0: 初期状態（カート放棄率60%）
- Step 1: ℐ (意図解決) - Step-Back Question
- Step 2: 𝒞 (コマンドスタック) - 3タスク分解
- Step 3: Θ (世界変換) - 6つの変換フェーズ
- Step 4: 収束 - 要求仕様完成（13個の要求）

### ビルド

```bash
npm run build
```

ビルド成果物は `dist/` ディレクトリに生成されます。

---

## 📦 プロジェクト構成

```
web/
├── src/
│   ├── components/          # Reactコンポーネント
│   │   ├── GraphView.tsx   # ✅ グラフ可視化（React Flow）
│   │   ├── ChatInterface.tsx # ✅ 1on1チャット
│   │   ├── AgentStatePanel.tsx # ✅ エージェント状態表示
│   │   ├── DemoControls.tsx # ✅ デモコントロール
│   │   └── Timeline.tsx     # 🚧 時系列表示（予定）
│   ├── stores/              # 状態管理（Zustand）
│   │   ├── agentStore.ts   # ✅ エージェント状態
│   │   ├── graphStore.ts   # ✅ グラフデータ
│   │   └── chatStore.ts    # ✅ チャット履歴
│   ├── demo/                # デモシナリオ
│   │   └── ecommerceAuthDemo.ts # ✅ ECサイト認証機能デモ
│   ├── hooks/               # カスタムフック
│   │   ├── useWebSocket.ts # 🚧 WebSocket通信（予定）
│   │   └── useAgent.ts     # 🚧 エージェント操作（予定）
│   ├── types/               # 型定義
│   │   └── index.ts        # ✅ 統一エージェント型
│   ├── utils/               # ユーティリティ
│   │   └── graphLayout.ts  # 🚧 グラフレイアウト計算（予定）
│   ├── App.tsx              # ✅ メインアプリ
│   ├── main.tsx             # ✅ エントリーポイント
│   └── index.css            # ✅ グローバルスタイル
├── public/                  # 静的ファイル
├── index.html               # ✅ HTMLテンプレート
├── package.json             # ✅ 依存関係定義
├── vite.config.ts           # ✅ Vite設定
├── tailwind.config.js       # ✅ Tailwind設定
├── postcss.config.js        # ✅ PostCSS設定
└── tsconfig.json            # ✅ TypeScript設定
```

---

## 🎨 UI構成

### 画面レイアウト

```
┌─────────────────────────────────────────────────┐
│  Seize - 統一エージェント方程式                    │
├─────────────────────────────────────────────────┤
│                                                   │
│  ┌─────────────────┐  ┌─────────────────────┐  │
│  │   GraphView     │  │   ChatInterface     │  │
│  │   (React Flow)  │  │   (1on1対話)        │  │
│  │                 │  │                      │  │
│  │   World₀        │  │  👤: 入力           │  │
│  │     ↓ ℐ        │  │  🤖: 応答           │  │
│  │   Goal          │  │                      │  │
│  │     ↓ 𝒞        │  │  [入力欄]           │  │
│  │   Plan          │  │  [送信]             │  │
│  │     ↓ Θ        │  │                      │  │
│  │   World₁        │  └─────────────────────┘  │
│  │                 │                             │
│  └─────────────────┘  ┌─────────────────────┐  │
│                        │ AgentStatePanel     │  │
│                        │  フェーズ: θ₃       │  │
│                        │  反復: 2/10         │  │
│                        │  収束率: 45%        │  │
│                        └─────────────────────┘  │
│                                                   │
└─────────────────────────────────────────────────┘
```

### コンポーネント

#### 1. GraphView (グラフビュー)

**技術**: React Flow
**機能**:
- 世界の状態遷移を可視化
- ノード: World, Intent (ℐ), Command (𝒞), Transform (Θ), Goal, Task
- エッジ: 状態遷移、処理フロー、依存関係
- インタラクション: ズーム、パン、ノードクリックで詳細表示

**ノードの色**:
- 🌍 World: 青 (#3B82F6)
- 🎯 Intent: 緑 (#10B981)
- 📋 Command: 紫 (#8B5CF6)
- ⚡ Transform: オレンジ (#F59E0B)
- 🎪 Goal: 黄 (#FBBF24)
- ✓ Task: グレー

#### 2. ChatInterface (チャットインターフェース)

**機能**:
- 人間とAIの1on1対話
- Markdown対応
- メッセージ送信（Enter）
- 履歴表示

**メッセージ形式**:
```typescript
{
  role: 'human' | 'ai' | 'system',
  content: string,
  timestamp: Date,
  metadata: {
    phase?: 'ℐ' | '𝒞' | 'Θ',
    worldVersion?: number
  }
}
```

#### 3. AgentStatePanel (エージェント状態パネル)

**表示項目**:
- 現在のフェーズ (ℐ / 𝒞 / Θ / idle)
- 反復回数 (2/10)
- 収束率 (0-100%)
- タスク進捗 (完了/実行中/保留)

#### 4. Timeline (タイムライン)

**機能**:
- 世界の変化履歴を時系列表示
- クリックで過去の状態に遡行
- アニメーション再生

---

## 🔧 技術スタック

### フロントエンド

- **Framework**: React 18 + TypeScript
- **ビルドツール**: Vite
- **スタイリング**: Tailwind CSS
- **グラフ描画**: React Flow
- **状態管理**: Zustand
- **通信**: WebSocket (Socket.io)
- **アニメーション**: Framer Motion

### バックエンド（予定）

- **言語**: Rust
- **Webフレームワーク**: Axum
- **WebSocket**: axum-socket
- **統一エージェント**: seize-core

---

## 🎯 使用例

### 1. 要求抽出の可視化

```
👤: ステークホルダーインタビューから要求を抽出してください

[グラフ]
World₀ が表示される

🤖: ℐ (意図解決)フェーズを開始します...

[グラフ]
World₀ → Intent (緑ノード) が追加される
アニメーション: フェードイン + 「瞬き」エフェクト

🤖: 目標を設定しました: "要求を抽出する"

[グラフ]
Intent → Goal (黄ノード) が追加される

🤖: 𝒞 (コマンドスタック)フェーズを開始します...

[グラフ]
Goal → Command (紫ノード) → Task1, Task2, Task3 が追加される

🤖: 3個のタスクに分解しました

🤖: Θ (世界変換)フェーズを開始します...

[グラフ]
Command → Transform (オレンジノード) → World₁ へ遷移
アニメーション: 「瞬き」エフェクト（状態遷移）

🤖: 要求抽出が完了しました。3個の要求を特定しました。

[エージェント状態パネル]
フェーズ: idle
反復: 1/10
収束率: 33%
```

### 2. インタラクティブな調整

```
👤: [グラフ内のTaskノードをクリック]

[サイドパネル]
Task詳細が表示される:
- ID: task_001
- 説明: "ステークホルダーインタビューを分析"
- ステータス: completed

👤: この要求の優先度をMustに変更してください

🤖: 要求の優先度をMustに更新しました

[グラフ]
該当ノードの色が変更（赤枠で強調）
```

---

## 📱 レスポンシブデザイン

- **デスクトップ (>1024px)**: 3カラムレイアウト
- **タブレット (768px-1024px)**: 2カラムレイアウト
- **モバイル (<768px)**: タブ切り替え（グラフ/チャット）

---

## 🔒 セキュリティ

- **WebSocket認証**: JWT トークン
- **XSS対策**: DOMPurifyでHTMLサニタイズ
- **CORS**: 許可されたオリジンのみ
- **レート制限**: 10req/分/ユーザー

---

## 🎓 アクセシビリティ

- **WCAG 2.1 AA準拠**
- **キーボードナビゲーション**: すべての操作可能
- **スクリーンリーダー対応**: ARIA属性
- **カラーコントラスト**: 4.5:1以上

---

## 📈 パフォーマンス

- **初回ロード**: 2秒以内（目標）
- **レスポンスタイム**: 100ms以内（UI操作）
- **グラフレンダリング**: 1000ノードまでスムーズ

---

## 🔄 開発状況

### 完了 ✅
- [x] プロジェクトセットアップ
- [x] 型定義（types/index.ts）
- [x] 状態管理（Zustand stores）
- [x] 設計ドキュメント
- [x] GraphViewコンポーネント（React Flow統合）
- [x] ChatInterfaceコンポーネント（1on1対話）
- [x] AgentStatePanelコンポーネント（リアルタイム状態表示）
- [x] DemoControlsコンポーネント（デモ再生機能）
- [x] ECサイト認証機能デモシナリオ（5ステップ）
- [x] メインアプリケーション統合（App.tsx）
- [x] レスポンシブレイアウト

### 実装予定 🚧
- [ ] WebSocket通信（リアルタイム双方向通信）
- [ ] バックエンドAPI (Rust/Axum)
- [ ] Timeline コンポーネント（履歴表示）
- [ ] カスタムフック（useWebSocket, useAgent）
- [ ] グラフレイアウト自動計算
- [ ] ノード・エッジのドラッグ&ドロップ編集
- [ ] エクスポート機能（PNG, SVG, JSON）
- [ ] 追加デモシナリオ（他の要求工学事例）

---

## 🤝 コントリビューション

プルリクエストを歓迎します！

### 開発の流れ

1. リポジトリをフォーク
2. フィーチャーブランチを作成
3. 変更を実装
4. `npm run lint` でコード品質チェック
5. `npm run format` でフォーマット
6. プルリクエストを作成

---

## 📚 参考資料

- [React Flow Documentation](https://reactflow.dev/)
- [Zustand Documentation](https://docs.pmnd.rs/zustand/)
- [Tailwind CSS](https://tailwindcss.com/)
- [統一エージェント方程式](../CLAUDE.md)

---

**人間とAIの協働を、次のレベルへ！**
